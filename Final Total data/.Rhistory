library("ggplot2", lib.loc="C:/Users/정은/Documents/R/win-library/3.4")
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
df <- read.csv("Sleeping princess in penguin room.csv")
life <- df[[3]]
gdp <- df[[4]]; sani <- df[[5]]; pre <- df[[6]]; pri <- df[[7]]
sec <- df[[8]]; ter <- df[[9]]; smo <- df[[11]]; ob <- df[[12]]
al <- df[[13]]; co2 <- df[[14]]; hiv <- df[[15]]
n <- nrow(df); p <- ncol(df) - 4
reg <- lm(life~gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv)
infl.id <- c(44, 106, 145)
df.1 <- df[-as.numeric(infl.id),]
life.1 <- df.1[[3]]
gdp.1 <- df.1[[4]]; sani.1 <- df.1[[5]]; pre.1 <- df.1[[6]]; pri.1 <- df.1[[7]]
sec.1 <- df.1[[8]]; ter.1 <- df.1[[9]]; smo.1 <- df.1[[11]]; ob.1 <- df.1[[12]]
al.1 <- df.1[[13]]; co2.1 <- df.1[[14]]; hiv.1 <- df.1[[15]]
n.1 <- nrow(df.1); p <- ncol(df.1) - 4
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
log.gdp <- log(gdp.1, 10); log.co2 <- log(co2.1, 2); log.hiv <- log(hiv.1, 2)
reg.0 <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
obg.0 <- summary(reg.0)
round(obg.0$coefficients, 4)
bic.1 <- lm(life.1~gdp.1+sani.1+pre.1+hiv.1)
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
anova(reg.1); anova(bic.1)
SSE.f <- anova(reg.1)[12,2]; df.Ef <- 135
SSE.r <- anova(bic.1)[5,2]; df.Er <- 139
F.stat <- ((SSE.r-SSE.f)/(df.Er - df.Ef))/(SSE.f/df.Ef)  ##p.value (0.002)
anova(bic.1, reg.1)
bic.2 <- lm(life.1~log.gdp+sani.1+pre.1+log.hiv)
reg.0 <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
anova(bic.2, reg.0)
SSE.f <- anova(reg.0)[12,2]; df.Ef <- 135
SSE.r <- anova(bic.2)[5,2]; df.Er <- 139
F.stat <- ((SSE.r-SSE.f)/(df.Er - df.Ef))/(SSE.f/df.Ef)  ##p.value (0.003)
reg.1
a <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+ter.1+smo.1+ob.1+hiv.1)
anova(a, reg.1)
reg.0
b <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+ter.1+smo.1+log.co2+log.hiv)
anova(b, reg.0)
install.packages("corrplot")
library("corrplot", lib.loc="C:/Users/정은/Documents/R/win-library/3.4")
rm(list=ls())
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
df <- read.csv("Sleeping princess in penguin room.csv")
infl.id <- c(44, 106, 145)
df.1 <- df[-as.numeric(infl.id),]
life.1 <- df.1[[3]]
gdp.1 <- df.1[[4]]; sani.1 <- df.1[[5]]; pre.1 <- df.1[[6]]; pri.1 <- df.1[[7]]
sec.1 <- df.1[[8]]; ter.1 <- df.1[[9]]; smo.1 <- df.1[[11]]; ob.1 <- df.1[[12]]
al.1 <- df.1[[13]]; co2.1 <- df.1[[14]]; hiv.1 <- df.1[[15]]
n.1 <- nrow(df.1); p <- ncol(df.1) - 4
reg.1
reg.r <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+ter.1+smo.1+ob.1+hiv.1)
log.gdp <- log(gdp.1, 10); log.co2 <- log(co2.1, 2); log.hiv <- log(hiv.1, 2)
reg.logr <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+ter.1+smo.1+log.co2+log.hiv)
library(corrplot)
corrplot(reg.r)
corrplot(df.1)
plot(df.1)
reg.r <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+ter.1+smo.1+ob.1+hiv.1)
df.r <- cbind(life = life.1, gdp = gdp.1, sani = sani.1, pre = pre.1,
pri = pri.1, ter = ter.1, smo = smo.1, ob = ob.1, hiv = hiv.1)
df.r <- as.data.frame(cbind(life = life.1, gdp = gdp.1, sani = sani.1, pre = pre.1,
pri = pri.1, ter = ter.1, smo = smo.1, ob = ob.1, hiv = hiv.1))
View(df.r)
plot(df.r)
plot(df.r)
df.logr<- as.data.frame(cbind(life = life.1, log.gdp = log.gdp, sani = sani.1, pre = pre.1,
pri = pri.1, ter = ter.1, smo = smo.1, log.co2 = log.co2, log.hiv = log.hiv))
plot(df.logr)
corrplot(df.logr, method="number")
corrplot(as.matrix(df.logr), method="number")
corrplot(df.r, method="number")
corr(sani, log.co2)
corr(sani.1, log.co2)
cor(sani.1, log.co2)
a <- cor(df[,i], df[,j])
cor.matrix <- matrix(0,7,7)
View(cor.matrix)
View(df.logr)
cor.matrix <- matrix(0,8,8)
colnames(cor.matrix) <- rownames(cor.matrix) <- colnames(df.logr)[-1]
cor(sani.1, log.co2)
for(i in 2:9){
for(j in 2:9){
a <- cor(df[,i], df[,j])
cor.matrix[i,j] <- a
}
}
for(i in 2:9){
for(j in 2:9){
a <- cor(df.logr[,i], df.logr[,j])
cor.matrix[i,j] <- a
}
}
View(cor.matrix)
View(cor.matrix)
View(cor.matrix)
View(cor.matrix)
cor(sani.1, log.co2)
for(i in 1:8){
for(j in 1:8){
a <- cor(df.logr[,i+1], df.logr[,j+1])
cor.matrix[i,j] <- a
}
}
View(cor.matrix)
round(cor.matrix, 4)
which(cor.matrix > 0.5)
cor.matrix[which(cor.matrix > 0.5)]
cor1.matrix <- matrix(0,8,8)
for(i in 1:8){
for(j in 1:8){
a <- cor(df.r[,i+1], df.r[,j+1])
cor1.matrix[i,j] <- a
}
}
round(cor.matrix, 4)
colnames(cor1.matrix) <- rownames(cor1.matrix) <- colnames(df.r)[-1]
plot(df.r)
cor1.matrix <- matrix(0,8,8)
colnames(cor1.matrix) <- rownames(cor1.matrix) <- colnames(df.r)[-1]
for(i in 1:8){
for(j in 1:8){
a <- cor(df.r[,i+1], df.r[,j+1])
cor1.matrix[i,j] <- a
}
}
round(cor1.matrix, 4)
vif(reg.logr)
library("DAAG", lib.loc="C:/Users/정은/Documents/R/win-library/3.4")
library(corrplot); library(DAAG)
vif(reg.logr)
vif(reg.r)
reg.r <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+ter.1+smo.1+ob.1+hiv.1)
anova(reg.r, reg.logr)
summary(reg.r)
arc(reg.r, reg.logr)
AIC(reg.r, reg.logr)
BIC(reg.r, reg.logr)
anova(reg.r, reg.logr)
summary(reg.r); summary(reg.logr)
plot(df.r)
plot(df)
plot(df[,-c(1,2,10)])
rm(list=ls())
plot(df.r)
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
df <- read.csv("Sleeping princess in penguin room.csv")
infl.id <- c(44, 106, 145)
df.1 <- df[-as.numeric(infl.id),]
life.1 <- df.1[[3]]
gdp.1 <- df.1[[4]]; sani.1 <- df.1[[5]]; pre.1 <- df.1[[6]]; pri.1 <- df.1[[7]]
sec.1 <- df.1[[8]]; ter.1 <- df.1[[9]]; smo.1 <- df.1[[11]]; ob.1 <- df.1[[12]]
al.1 <- df.1[[13]]; co2.1 <- df.1[[14]]; hiv.1 <- df.1[[15]]
n.1 <- nrow(df.1); p <- ncol(df.1) - 4
library(corrplot); library(DAAG)
reg.r <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+ter.1+smo.1+ob.1+hiv.1)
df.r <- as.data.frame(cbind(life = life.1, gdp = gdp.1, sani = sani.1, pre = pre.1,
pri = pri.1, ter = ter.1, smo = smo.1, ob = ob.1, hiv = hiv.1))
plot(df.r)
cor1.matrix <- matrix(0,8,8)
colnames(cor1.matrix) <- rownames(cor1.matrix) <- colnames(df.r)[-1]
rm(list=ls())
