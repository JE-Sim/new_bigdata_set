recentYear <- function(data) {
data1 <- data[,c(1,2)]
data <- data[,-c(1,2)]
for(i in 1:nrow(data)){
index <- !is.na(data[i,])
index.1 <- order(index)[length(index)]
data1$referenceYear[i] <- colnames(data)[index.1]
data1$total[i] <- data[i, index.1]
}
return(data1)
}
setwd("C:/Users/정은/Desktop/빅데이터/BigData-Analysis/raw data")
CO.2 <- read.csv("CO2 raw data.csv", header = T)
CO.2.1 <- recentYear(CO.2)
CO.2.1 <- na.omit(CO.2.1)
CO.2.1 <- CO.2.1[,-3]
colnames(CO.2.1) <- c("Country.Name", "Country.Code", "CO.2")
write.csv(CO.2.1, "CO.2.revised.CSV", row.names = F)
HIV <- read.csv("HIV raw data.csv", header = T)
setwd("C:/Users/정은/Desktop/빅데이터/BigData-Analysis/final.dataset")
life <- read.csv("life.expectancy.revised.csv")
life <- life[,c(2, 3, 5)]
conti <- read.csv("All.asia.csv")
gdp <- read.csv("GDP.revised.csv")
sani <- read.csv("Sanitation.revised.csv")
edu <- read.csv("edu.recent.csv")
smo <- read.csv("Smoking.final.csv")
smo <- smo[,-3]
ob <- read.csv("Obesity.2016.csv")
colnames(ob)[3] <- "obesity"
al <- read.csv("Alchol.revised2.csv")
co2 <- read.csv("CO.2.revised.csv")
colnames(co2)[3] <- "CO2"
hiv <- read.csv("HIV.revised.csv")
cont <- conti[,c(1, 3, 4)]
levels(cont[ ,3])
code <- as.numeric(cont[,3])
code.matrix <- matrix(0, 248, 4)
code.matrix[1:248 + 248*(code-1)] <- 1
colnames(code.matrix) <- c("af", "am", "aa", "eu")
dummy <- cbind(cont[,-3], code.matrix[,c(3, 1, 2, 4)])
X <- merge(dummy, gdp, key = Country.Code)
X <- merge(X, sani, key = Country.Code)
X <- merge(X, edu, key = Country.Code)
X <- merge(X, smo, key = Country.Code)
X <- merge(X, ob, key = Country.Code)
X <- merge(X, al, key = Country.Code)
X <- merge(X, co2, key = Country.Code)
X <- merge(X, hiv, key = Country.Code)
Total <- merge(life, X, key = Country.Code)
colnames(Total) <- c("Country.Name","Country.Code","life", "aa", "am",
"af", "eu", "gdp", "sani", "pre", "pri", "sec",
"ter", "smo", "ob", "al", "co2", "hiv")
View(X)
View(cont)
View(conti)
rm(list=ls())
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
df <- read.csv("Sleeping princess in penguin room.csv")
infl.id <- c(44, 106, 145)
df.1 <- df[-as.numeric(infl.id),]
life.1 <- df.1[[3]]
gdp.1 <- df.1[[4]]; sani.1 <- df.1[[5]]; pre.1 <- df.1[[6]]; pri.1 <- df.1[[7]]
sec.1 <- df.1[[8]]; ter.1 <- df.1[[9]]; smo.1 <- df.1[[11]]; ob.1 <- df.1[[12]]
al.1 <- df.1[[13]]; co2.1 <- df.1[[14]]; hiv.1 <- df.1[[15]]
n.1 <- nrow(df.1); p <- ncol(df.1) - 4
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
log.gdp <- log(gdp.1, 10); log.co2 <- log(co2.1, 2); log.hiv <- log(hiv.1, 2)
reg.0 <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
obg.0 <- summary(reg.0)
round(obg.0$coefficients, 4)
View(df)
cp.X <- as.data.frame(cbind(gdp = gdp.1, sani = sani.1, pre = pre.1, pri = pri.1,
ter = ter.1, smo = smo.1, ob = ob.1, hiv = hiv.1))
reg.1
a <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+ter.1+smo.1+ob.1+hiv.1)
anova(a, reg.1)
reg.0
cp.logX <- as.data.frame(cbind(log.gdp = log.gdp, sani = sani.1, pre = pre.1, pri = pri.1,
ter = ter.1, smo = smo.1, log.co2 = log.co2, log.hiv = log.hiv))
b <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+ter.1+smo.1+log.co2+log.hiv)
anova(b, reg.0)
list.obj <- list()
for (j in c(1:8)){
obj <- lm(life.1 ~ cp.X[,j])
list.obj[j] <- obj
}
par(mfrow = c(3, 3))
for (j in c(1:8)){
plot(cp.X[,j], life.1, color=c("white","gray"), xlab=colnames(cp.X)[j], main=paste("x", j))
abline(lm(life.1~cp.X[,j]), col="red")
}
par(mfrow = c(3, 3))
for (j in c(1:8)){
plot(cp.X[,j], life.1, color=c("white","gray"), xlab=colnames(cp.X)[j], main=paste("x", j))
abline(lm(life.1~cp.X[,j]), col="red")
}
par(mfrow = c(3, 4))
for (j in c(2:13)){
plot(df1[,j], life, color=c("white","gray"), xlab=colnames(df1)[j], main=paste("x", j))
abline(lm(life~df1[,j]), col="red")
}
rm(list=ls())
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
df <- read.csv("Sleeping princess in penguin room.csv")
life <- df[[3]]
gdp <- df[[4]]; sani <- df[[5]]; pre <- df[[6]]; pri <- df[[7]]
sec <- df[[8]]; ter <- df[[9]]; smo <- df[[11]]; ob <- df[[12]]
al <- df[[13]]; co2 <- df[[14]]; hiv <- df[[15]]
reg <- lm(life~gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv)
par(mfrow = c(1,2))
plot(reg$residuals, type = "n", main = "residual plot", ylab = "residuals"); abline(h=0, lty="dotted")
text(reg$residuals, names(reg$residuals), cex = 0.7)
plot(reg$fitted.values, reg$residuals, type = "n", main = "residual plot", xlab = "y.hat", ylab = "residuals")
abline(h = 0, lty = "dotted")
text(reg$fitted.values, reg$residuals, names(reg$fitted.values), cex = 0.7)
df$Country.Name[which(reg$fitted.values >= 75)]
anova.reg <- anova(reg); anova.reg
df1 <- df[,-c(1, 2, 10)]
list.obj <- list()
for (j in c(2:13)){
obj <- lm(life ~ df1[,j])
i <- j-1
list.obj[i] <- obj
}
par(mfrow = c(3, 4))
for (j in c(2:13)){
plot(df1[,j], life, color=c("white","gray"), xlab=colnames(df1)[j], main=paste("x", j))
abline(lm(life~df1[,j]), col="red")
}
Mode <- function(x) {
ux <- unique(x)
ux[which.max(tabulate(match(x,ux)))]
}
par(mfrow = c(1,2))
plot(reg$residuals, type = "n", main = "residual plot", ylab = "residuals"); abline(h=0, lty="dotted")
text(reg$residuals, names(reg$residuals), cex = 0.7)
plot(reg$fitted.values, reg$residuals, type = "n", main = "residual plot", xlab = "y.hat", ylab = "residuals")
abline(h = 0, lty = "dotted")
text(reg$fitted.values, reg$residuals, names(reg$fitted.values), cex = 0.7)
df$Country.Name[which(reg$fitted.values >= 75)]
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
df <- read.csv("Sleeping princess in penguin room.csv")
life <- df[[3]]
gdp <- df[[4]]; sani <- df[[5]]; pre <- df[[6]]; pri <- df[[7]]
sec <- df[[8]]; ter <- df[[9]]; smo <- df[[11]]; ob <- df[[12]]
al <- df[[13]]; co2 <- df[[14]]; hiv <- df[[15]]
n <- nrow(df); p <- ncol(df) - 4
reg <- lm(life~gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv)
infl.id <- c(44, 106, 145)
df.1 <- df[-as.numeric(infl.id),]
life.1 <- df.1[[3]]
gdp.1 <- df.1[[4]]; sani.1 <- df.1[[5]]; pre.1 <- df.1[[6]]; pri.1 <- df.1[[7]]
sec.1 <- df.1[[8]]; ter.1 <- df.1[[9]]; smo.1 <- df.1[[11]]; ob.1 <- df.1[[12]]
al.1 <- df.1[[13]]; co2.1 <- df.1[[14]]; hiv.1 <- df.1[[15]]
n.1 <- nrow(df.1); p <- ncol(df.1) - 4
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
log.gdp <- log(gdp.1, 10); log.co2 <- log(co2.1, 2); log.hiv <- log(hiv.1, 2)
reg.0 <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
obg.0 <- summary(reg.0)
round(obg.0$coefficients, 4)
rm(list=ls())
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
df <- read.csv("Sleeping princess in penguin room.csv")
life <- df[[3]]
gdp <- df[[4]]; sani <- df[[5]]; pre <- df[[6]]; pri <- df[[7]]
sec <- df[[8]]; ter <- df[[9]]; smo <- df[[11]]; ob <- df[[12]]
al <- df[[13]]; co2 <- df[[14]]; hiv <- df[[15]]
n <- nrow(df); p <- ncol(df) - 4
reg <- lm(life~gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv)
infl.id <- c(44, 106, 145)
df.1 <- df[-as.numeric(infl.id),]
life.1 <- df.1[[3]]
gdp.1 <- df.1[[4]]; sani.1 <- df.1[[5]]; pre.1 <- df.1[[6]]; pri.1 <- df.1[[7]]
sec.1 <- df.1[[8]]; ter.1 <- df.1[[9]]; smo.1 <- df.1[[11]]; ob.1 <- df.1[[12]]
al.1 <- df.1[[13]]; co2.1 <- df.1[[14]]; hiv.1 <- df.1[[15]]
n.1 <- nrow(df.1); p <- ncol(df.1) - 4
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
log.gdp <- log(gdp.1, 10); log.co2 <- log(co2.1, 2); log.hiv <- log(hiv.1, 2)
reg.0 <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
obg.0 <- summary(reg.0)
round(obg.0$coefficients, 4)
bic.1 <- lm(life.1~gdp.1+sani.1+pre.1+hiv.1)
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
anova(reg.1); anova(bic.1)
SSE.f <- anova(reg.1)[12,2]; df.Ef <- 135
SSE.r <- anova(bic.1)[5,2]; df.Er <- 139
F.stat <- ((SSE.r-SSE.f)/(df.Er - df.Ef))/(SSE.f/df.Ef)  ##p.value (0.002)
anova(bic.1, reg.1)
bic.2 <- lm(life.1~log.gdp+sani.1+pre.1+log.hiv)
reg.0 <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
anova(bic.2, reg.0)
SSE.f <- anova(reg.0)[12,2]; df.Ef <- 135
SSE.r <- anova(bic.2)[5,2]; df.Er <- 139
F.stat <- ((SSE.r-SSE.f)/(df.Er - df.Ef))/(SSE.f/df.Ef)  ##p.value (0.003)
reg.1
a <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+ter.1+smo.1+ob.1+hiv.1)
anova(a, reg.1)
reg.0
b <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+ter.1+smo.1+log.co2+log.hiv)
anova(b, reg.0)
rm(list=ls())
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
df <- read.csv("Sleeping princess in penguin room.csv")
infl.id <- c(44, 106, 145)
df.1 <- df[-as.numeric(infl.id),]
life.1 <- df.1[[3]]
gdp.1 <- df.1[[4]]; sani.1 <- df.1[[5]]; pre.1 <- df.1[[6]]; pri.1 <- df.1[[7]]
sec.1 <- df.1[[8]]; ter.1 <- df.1[[9]]; smo.1 <- df.1[[11]]; ob.1 <- df.1[[12]]
al.1 <- df.1[[13]]; co2.1 <- df.1[[14]]; hiv.1 <- df.1[[15]]
n.1 <- nrow(df.1); p <- ncol(df.1) - 4
library(corrplot); library(DAAG)
reg.r <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+ter.1+smo.1+ob.1+hiv.1)
df.r <- as.data.frame(cbind(life = life.1, gdp = gdp.1, sani = sani.1, pre = pre.1,
pri = pri.1, ter = ter.1, smo = smo.1, ob = ob.1, hiv = hiv.1))
plot(df.r)
cor1.matrix <- matrix(0,8,8)
