list.obj <- list()
j <- 2L
for (j in 2:13){
obj <- lm(life ~ df1[,j])
plot(df1[,j], life, xlab=colnames(df1)[j], main=paste("x", j))
abline(obj, col = "red")
}
for (j in 2:13){
obj <- lm(life ~ df1[,j])
list.obj[j-1] <- obj
}
setwd("C:/Users/정은/Desktop/new_bigdata_set/final data revised")
setwd("C:/Users/정은/Desktop/new_bigdata_set/Final Total data")
rm(list=ls())
setwd("C:/Users/정은/Desktop/new_bigdata_set/Final Total data")
df <- read.csv("Sleeping princess in penguin room.csv")
df <- df[,-10]; colnames(df)[c(3,10)] <- c("life", "smo")
setwd("C:/Users/정은/Desktop/new_bigdata_set/Final Total data")
df <- read.csv("Sleeping princess in penguin room.csv")
life <- df[[3]]
gdp <- df[[4]]; sani <- df[[5]]; pre <- df[[6]]; pri <- df[[7]]
sec <- df[[8]]; ter <- df[[9]]; smo <- df[[11]]; ob <- df[[12]]
al <- df[[13]]; co2 <- df[[14]]; hiv <- df[[15]]
df <- df[,-10]; colnames(df)[c(3,10)] <- c("life", "smo")
View(df)
View(df)
View(df)
df <- read.csv("Sleeping princess in penguin room.csv")
View(df)
df <- df[,-10]; colnames(df)[c(3,10)] <- c("life", "smo")
life <- df[[3]]
gdp <- df[[4]]; sani <- df[[5]]; pre <- df[[6]]; pri <- df[[7]]
sec <- df[[8]]; ter <- df[[9]]; smo <- df[[10]]; ob <- df[[11]]
al <- df[[12]]; co2 <- df[[13]]; hiv <- df[[14]]
reg <- lm(life~gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv)
summary(reg)
setwd("C:/Users/정은/Desktop/new_bigdata_set/Final Total data")
df <- read.csv("Sleeping princess in penguin room.csv")
df <- df[,-10]; colnames(df)[c(3,10)] <- c("life", "smo")
life <- df[[3]]
gdp <- df[[4]]; sani <- df[[5]]; pre <- df[[6]]; pri <- df[[7]]
sec <- df[[8]]; ter <- df[[9]]; smo <- df[[10]]; ob <- df[[11]]
al <- df[[12]]; co2 <- df[[13]]; hiv <- df[[14]]
reg <- lm(life~gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv)
summary(reg)
par(mfrow=c(1,1))
plot(reg$residuals, type = "n", main = "residual plot", ylab = "residuals"); abline(h=0, lty="dotted")
text(reg$residuals, names(reg$residuals), cex = 0.7)
plot(reg$fitted.values, reg$residuals, type = "n", main = "residual plot", xlab = "y.hat", ylab = "residuals")
abline(h = 0, lty = "dotted")
text(reg$fitted.values, reg$residuals, names(reg$fitted.values), cex = 0.7)
par(mfrow = c(3, 4))
list.obj <- list()
j <- 2L
for (j in 2:13){
obj <- lm(life ~ df1[,j])
plot(df1[,j], life, xlab=colnames(df1)[j], main=paste("x", j))
abline(obj, col = "red")
}
df1 <- df[,-c(1, 2, 10)]
View(df1)
df1 <- df[,-c(1, 2)]
View(df1)
par(mfrow = c(3, 4))
list.obj <- list()
j <- 2L
for (j in 2:13){
obj <- lm(life ~ df1[,j])
plot(df1[,j], life, xlab=colnames(df1)[j], main=paste("x", j))
abline(obj, col = "red")
}
for (j in 2:13){
obj <- lm(life ~ df1[,j])
list.obj[j-1] <- obj
}
df2 <- cbind(log(gdp, 10), sani, pre, smo, al, log(co2, 2), log(hiv, 2))
colnames(df2) <- c("log.gdp", "sani", "pre", "smo", "al", "log.co2", "log.hiv")
par(mfrow = c(3, 3))
for (j in c(1:7)){
plot(df2[,j], life, color=c("white","gray"), xlab=colnames(df2)[j], main=paste("x", j))
}
par(mfrow = c(4, 2))
for (j in c(1:7)){
obj2 <- lm(life~df2[,j])
plot(df2[,j], life, color=c("white","gray"), xlab=colnames(df2)[j], main=paste("x", j))
abline(obj2, col = "red")
}
par(mfrow = c(2, 4))
for (j in c(1:7)){
obj2 <- lm(life~df2[,j])
plot(df2[,j], life, color=c("white","gray"), xlab=colnames(df2)[j], main=paste("x", j))
abline(obj2, col = "red")
}
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
DF <- read.csv("Sleeping princess in penguin room.csv")
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
DF <- read.csv("Sleeping princess in penguin room.csv")
rm(list=ls())
DF <- read.csv("Sleeping princess in penguin room.csv")
life <- DF[[3]]
gdp <- DF[[4]]; sani <- DF[[5]]; pre <- DF[[6]]; pri <- DF[[7]]
sec <- DF[[8]]; ter <- DF[[9]]; smo <- DF[[11]]; ob <- DF[[12]]
al <- DF[[13]]; co2 <- DF[[14]]; hiv <- DF[[15]]
n <- nrow(DF); p <- ncol(DF) - 4
reg <- lm(life~gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv)
par(mfrow = c(1,2))
plot(reg$residuals, type = "n", main = "residual plot", ylab = "residuals"); abline(h=0, lty="dotted")
text(reg$residuals, names(reg$residuals), cex = 0.7)
plot(reg$fitted.values, reg$residuals, type = "n", main = "residual plot", xlab = "y.hat", ylab = "residuals")
abline(h = 0, lty = "dotted")
text(reg$fitted.values, reg$residuals, names(reg$fitted.values), cex = 0.7)
DF$Country.Name[which(reg$fitted.values >= 75)]
anova.reg <- anova(reg); anova.reg
library(lmtest)
dwtest(life ~ gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv) # H0이 독립.
dwtest(life ~ gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv) # H0이 독립.
r <- reg$residuals
mse <- t(r) %*% r / (n - p - 1)
e <- r/c(sqrt(mse))
par(mfrow = c(1,1))
qqnorm(e)
abline(0, 1, col=2)
alpha <- 0.05
temp <- (n - p - 2)/ (n - p - 1 - r^2)
t <- r * sqrt(abs(temp)) * sign(temp)
out.id <- which(abs(t) > qt(1-alpha/2, n - p - 2)); out.id
y.hat <- reg$fitted.values
plot(e, type = "n", xlab = "index", ylab = "residual", main="studentized residual")
text(e, cex = 0.7)
text(out.id, e[out.id], out.id, col=2, cex = 0.7)
abline(h = 0, col = 2, lty = 2)
points(out.id, e[out.id], col = 4, cex = 2)
alpha <- 0.05
temp <- (n - p - 2)/ (n - p - 1 - r^2)
t <- r * sqrt(abs(temp)) * sign(temp)
out.id <- which(abs(t) > qt(1-alpha/2, n - p - 2)); out.id
y.hat <- reg$fitted.values
plot(e, type = "n", xlab = "index", ylab = "residual", main="studentized residual")
text(e, cex = 0.7)
text(out.id, e[out.id], out.id, col=2, cex = 0.7)
abline(h = 0, col = 2, lty = 2)
alpha <- 0.05
temp <- (n - p - 2)/ (n - p - 1 - r^2)
t <- r * sqrt(abs(temp)) * sign(temp)
out.id <- which(abs(t) > qt(1-alpha/2, n - p - 2)); out.id
y.hat <- reg$fitted.values
plot(e, type = "n", xlab = "index", ylab = "residual", main="studentized residual")
text(e, cex = 0.7)
text(out.id, e[out.id], out.id, col=2, cex = 0.7)
abline(h = 0, col = 2, lty = 2)
summary(y.hat)
IQR <- quantile(r, prob = 0.75) - quantile(r, prob = 0.25)
lower.bound <- quantile(r, prob = 0.25) - 1.5*IQR
upper.bound <- quantile(r, prob = 0.75) + 1.5*IQR
out.IQR <- which(r <= lower.bound | r >= upper.bound)
y.hat <- reg$fitted.values
plot(r, type = "n", xlab = "index", ylab = "residual", main = "1.5 IQR outlier")
text(r, cex = 0.7)
text(out.IQR, r[out.IQR], out.IQR, col=2, cex = 0.7)
abline(h = 0, col = 2, lty = 2)
points(out.IQR, r[out.IQR], col = 4, cex = 2)
y.hat <- reg$fitted.values
plot(r, type = "n", xlab = "index", ylab = "residual", main = "1.5 IQR outlier")
text(r, cex = 0.7)
text(out.IQR, r[out.IQR], out.IQR, col=2, cex = 0.7)
abline(h = 0, col = 2, lty = 2)
points(out.IQR, r[out.IQR], col = 4, cex = 2.2)
y.hat <- reg$fitted.values
plot(r, type = "n", xlab = "index", ylab = "residual", main = "1.5 IQR outlier")
text(r, cex = 0.7)
text(out.IQR, r[out.IQR], out.IQR, col=2, cex = 0.7)
abline(h = 0, col = 2, lty = 2)
points(out.IQR, r[out.IQR], col = 4, cex = 2.5)
y.hat <- reg$fitted.values
plot(r, type = "n", xlab = "index", ylab = "residual", main = "1.5 IQR outlier")
text(r, cex = 0.7)
abline(h = 0, col = 2, lty = 2)
text(out.IQR, r[out.IQR], out.IQR, col=2, cex = 0.7)
points(out.IQR, r[out.IQR], col = 4, cex = 3)
boxplot(r, main = "residual box plot")
boxplot(r, main = "residual box plot", horizontal = T)
X1 <- as.matrix(DF[,-c(1, 2, 3, 10)])
X1[,1] <- X1[,1]/(10^9)  #gdp 너무 커서 R이 못견뎌요. 근데 double로 형변환하기는 싫어요.
X <- cbind(rep(1, n), X1)
H <- X %*% solve(t(X) %*% X) %*% t(X)
h <- diag(H)
C <- ((r^2)/(p+1)) * (h/(1-h))
infl.id <- names(C)[C > 1]
plot(C, type = "n")
text(C, cex = 0.7)
abline(h = 1, col = 2, lty = 2)
points(infl.id, C[infl.id], col = 4, cex = 2.2)
plot(C, type = "n", main = "Cook's distance, influential point")
text(C, cex = 0.7)
abline(h = 1, col = 2, lty = 2)
points(infl.id, C[infl.id], col = 4, cex = 2.2)
plot(C, type = "n", main = "Cook's distance, influential point")
text(C, cex = 0.7)
abline(h = 1, col = 2, lty = 2)
points(infl.id, C[infl.id], col = 4, cex = 3)
DFFITS <- t * sqrt(h / (1 - h))
plot(DFFITS, ylim = c(-0.5, 3.5), type = "n", main = "DFFITS, influential points")
text(abs(DFFITS), cex = 0.7)
abline(h = 2 * sqrt((p + 1)/(n - p - 1)), col = 2, lty = 2)
DF.1 <- DF[-as.numeric(infl.id),]
life.1 <- DF.1[[3]]
gdp.1 <- DF.1[[4]]; sani.1 <- DF.1[[5]]; pre.1 <- DF.1[[6]]; pri.1 <- DF.1[[7]]
sec.1 <- DF.1[[8]]; ter.1 <- DF.1[[9]]; smo.1 <- DF.1[[11]]; ob.1 <- DF.1[[12]]
al.1 <- DF.1[[13]]; co2.1 <- DF.1[[14]]; hiv.1 <- DF.1[[15]]
n.1 <- nrow(DF.1); p <- ncol(DF.1) - 4
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
obj <- summary(reg.1)
names(obj)
round(obj$coefficients, 4)
log.gdp <- log(gdp.1, 10); log.co2 <- log(co2.1, 2); log.hiv <- log(hiv.1, 2)
reg.log <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
obj.log <- summary(reg.log)
round(obj.log$coefficients, 4)
rm(list=ls())
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
DF <- read.csv("Sleeping princess in penguin room.csv")
life <- DF[[3]]
gdp <- DF[[4]]; sani <- DF[[5]]; pre <- DF[[6]]; pri <- DF[[7]]
sec <- DF[[8]]; ter <- DF[[9]]; smo <- DF[[11]]; ob <- DF[[12]]
al <- DF[[13]]; co2 <- DF[[14]]; hiv <- DF[[15]]
reg <- lm(life~gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv)
par(mfrow = c(1,2))
plot(reg$residuals, type = "n", main = "residual plot", ylab = "residuals"); abline(h=0, lty="dotted")
text(reg$residuals, names(reg$residuals), cex = 0.7)
plot(reg$fitted.values, reg$residuals, type = "n", main = "residual plot", xlab = "y.hat", ylab = "residuals")
abline(h = 0, lty = "dotted")
text(reg$fitted.values, reg$residuals, names(reg$fitted.values), cex = 0.7)
DF$Country.Name[which(reg$fitted.values >= 75)]
anova.reg <- anova(reg); anova.reg
DF1 <- DF[,-c(1, 2, 10)]
list.obj <- list()
for (j in c(2:13)){
obj <- lm(life ~ DF1[,j])
i <- j-1
list.obj[i] <- obj
}
par(mfrow = c(3, 4))
for (j in c(2:13)){
plot(DF1[,j], life, color=c("white","gray"), xlab=colnames(DF1)[j], main=paste("x", j))
abline(lm(life~DF1[,j]), col="red")
}
Mode <- function(x) {
ux <- unique(x)
ux[which.max(tabulate(match(x,ux)))]
}
DFlog <- cbind(log(gdp, 10), sani, pre, smo, al, log(co2, 2), log(hiv, 2))
colnames(DFlog) <- c("log.gdp", "sani", "pre", "smo", "al", "log.co2", "log.hiv")
par(mfrow = c(2, 4))
for (j in c(1:7)){
plot(DFlog[,j], life, color=c("white","gray"), xlab=colnames(DFlog)[j], main=paste("x", j))
}
for (j in c(1:7)){
answer <- c(answer, cor(life, DFlog[,j]))
}
answer
plot(smo ~ ob)
answer <- NULL
plot(log(gdp, 10) ~ ob)
plot(al ~ ob)
rm(list=ls())
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
DF <- read.csv("Sleeping princess in penguin room.csv")
infl.id <- c(44, 106, 145)
DF.1 <- DF[-as.numeric(infl.id),]
life.1 <- DF.1[[3]]
gdp.1 <- DF.1[[4]]; sani.1 <- DF.1[[5]]; pre.1 <- DF.1[[6]]; pri.1 <- DF.1[[7]]
sec.1 <- DF.1[[8]]; ter.1 <- DF.1[[9]]; smo.1 <- DF.1[[11]]; ob.1 <- DF.1[[12]]
al.1 <- DF.1[[13]]; co2.1 <- DF.1[[14]]; hiv.1 <- DF.1[[15]]
n.1 <- nrow(DF.1); p <- ncol(DF.1) - 4
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
log.gdp <- log(gdp.1, 10); log.co2 <- log(co2.1, 2); log.hiv <- log(hiv.1, 2)
reg.log <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
obg.log <- summary(reg.log)
round(obg.log$coefficients, 4)
cp.X <- as.data.frame(cbind(gdp = gdp.1, sani = sani.1, pre = pre.1, pri = pri.1,
ter = ter.1, smo = smo.1, ob = ob.1, hiv = hiv.1))
reg.1
anova(reg.cp, reg.1)
reg.cp <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+ter.1+smo.1+ob.1+hiv.1)
rm(list=ls())
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
DF <- read.csv("Sleeping princess in penguin room.csv")
life <- DF[[3]]
gdp <- DF[[4]]; sani <- DF[[5]]; pre <- DF[[6]]; pri <- DF[[7]]
sec <- DF[[8]]; ter <- DF[[9]]; smo <- DF[[11]]; ob <- DF[[12]]
al <- DF[[13]]; co2 <- DF[[14]]; hiv <- DF[[15]]
n <- nrow(DF); p <- ncol(DF) - 4
reg <- lm(life~gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv)
infl.id <- c(44, 106, 145)
DF.1 <- DF[-as.numeric(infl.id),]
life.1 <- DF.1[[3]]
gdp.1 <- DF.1[[4]]; sani.1 <- DF.1[[5]]; pre.1 <- DF.1[[6]]; pri.1 <- DF.1[[7]]
sec.1 <- DF.1[[8]]; ter.1 <- DF.1[[9]]; smo.1 <- DF.1[[11]]; ob.1 <- DF.1[[12]]
al.1 <- DF.1[[13]]; co2.1 <- DF.1[[14]]; hiv.1 <- DF.1[[15]]
n.1 <- nrow(DF.1); p <- ncol(DF.1) - 4
reg.f <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
log.gdp <- log(gdp.1, 10); log.co2 <- log(co2.1, 2); log.hiv <- log(hiv.1, 2)
reg.log <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
obg.log <- summary(reg.log)
round(obg.log$coefficients, 4)
library(leaps)
best.obj <- regsubsets(life.1 ~ ., DF.1[,-c(1, 2, 3, 10)])
obj <- summary(best.obj)
obj$which
obj$rsq
which.max(obj$adjr2)
which.min(obj$cp)
which.min(obj$bic)
bic.1 <- lm(life.1~gdp.1+sani.1+pre.1+hiv.1)
summary(bic.1)
df2 <- as.data.frame(cbind(log.gdp, sani.1, pre.1, pri.1, sec.1, ter.1, smo.1, ob.1, al.1 ,log.co2 ,log.hiv))
best.obj <- regsubsets(life.1 ~ ., df2)
obj <- summary(best.obj)
obj$which
obj$rsq
which.max(obj$adjr2)
which.min(obj$cp)
which.min(obj$bic)
bic.log <- lm(life.1~log.gdp+sani.1+pre.1+log.hiv)
summary(bic.log)
rm(list=ls())
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
DF <- read.csv("Sleeping princess in penguin room.csv")
infl.id <- c(44, 106, 145)
DF.1 <- DF[-as.numeric(infl.id),]
life.1 <- DF.1[[3]]
gdp.1 <- DF.1[[4]]; sani.1 <- DF.1[[5]]; pre.1 <- DF.1[[6]]; pri.1 <- DF.1[[7]]
sec.1 <- DF.1[[8]]; ter.1 <- DF.1[[9]]; smo.1 <- DF.1[[11]]; ob.1 <- DF.1[[12]]
al.1 <- DF.1[[13]]; co2.1 <- DF.1[[14]]; hiv.1 <- DF.1[[15]]
n.1 <- nrow(DF.1); p <- ncol(DF.1) - 4
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
rm(list=ls())
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
DF <- read.csv("Sleeping princess in penguin room.csv")
life <- DF[[3]]
gdp <- DF[[4]]; sani <- DF[[5]]; pre <- DF[[6]]; pri <- DF[[7]]
sec <- DF[[8]]; ter <- DF[[9]]; smo <- DF[[11]]; ob <- DF[[12]]
al <- DF[[13]]; co2 <- DF[[14]]; hiv <- DF[[15]]
n <- nrow(DF); p <- ncol(DF) - 4
reg.full <- lm(life~gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv)
infl.id <- c(44, 106, 145)
DF.1 <- DF[-as.numeric(infl.id),]
life.1 <- DF.1[[3]]
gdp.1 <- DF.1[[4]]; sani.1 <- DF.1[[5]]; pre.1 <- DF.1[[6]]; pri.1 <- DF.1[[7]]
sec.1 <- DF.1[[8]]; ter.1 <- DF.1[[9]]; smo.1 <- DF.1[[11]]; ob.1 <- DF.1[[12]]
al.1 <- DF.1[[13]]; co2.1 <- DF.1[[14]]; hiv.1 <- DF.1[[15]]
n.1 <- nrow(DF.1); p <- ncol(DF.1) - 4
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
DF <- read.csv("Sleeping princess in penguin room.csv")
life <- DF[[3]]
gdp <- DF[[4]]; sani <- DF[[5]]; pre <- DF[[6]]; pri <- DF[[7]]
sec <- DF[[8]]; ter <- DF[[9]]; smo <- DF[[11]]; ob <- DF[[12]]
al <- DF[[13]]; co2 <- DF[[14]]; hiv <- DF[[15]]
n <- nrow(DF); p <- ncol(DF) - 4
reg.full <- lm(life~gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv)
infl.id <- c(44, 106, 145)
DF.1 <- DF[-as.numeric(infl.id),]
life.1 <- DF.1[[3]]
gdp.1 <- DF.1[[4]]; sani.1 <- DF.1[[5]]; pre.1 <- DF.1[[6]]; pri.1 <- DF.1[[7]]
sec.1 <- DF.1[[8]]; ter.1 <- DF.1[[9]]; smo.1 <- DF.1[[11]]; ob.1 <- DF.1[[12]]
al.1 <- DF.1[[13]]; co2.1 <- DF.1[[14]]; hiv.1 <- DF.1[[15]]
n.1 <- nrow(DF.1); p <- ncol(DF.1) - 4
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
log.gdp <- log(gdp.1, 10); log.co2 <- log(co2.1, 2); log.hiv <- log(hiv.1, 2)
reg.log <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
obg.log <- summary(reg.log)
round(obg.log$coefficients, 4)
bic.1 <- lm(life.1~gdp.1+sani.1+pre.1+hiv.1)
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
anova(reg.1); anova(bic.1)
bic.1 <- lm(life.1~gdp.1+sani.1+pre.1+hiv.1)
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
anova(bic.1, reg.1)
bic.log <- lm(life.1~log.gdp+sani.1+pre.1+log.hiv)
reg.log <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
anova(bic.log, reg.log)
SSE.f <- anova(reg.log)[12,2]; DF.Ef <- 135
SSE.r <- anova(bic.2)[5,2]; DF.Er <- 139
F.stat <- ((SSE.r-SSE.f)/(DF.Er - DF.Ef))/(SSE.f/DF.Ef)  ##p.value (0.003)
bic.log <- lm(life.1~log.gdp+sani.1+pre.1+log.hiv)
reg.log <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
anova(bic.log, reg.log)
reg.1
reg.cp <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+ter.1+smo.1+ob.1+hiv.1)
anova(reg.cp, reg.1)
reg.log
reg.logcp<- lm(life.1~log.gdp+sani.1+pre.1+pri.1+ter.1+smo.1+log.co2+log.hiv)
anova(reg.logcp, reg.log)
rm(list=ls())
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
DF <- read.csv("Sleeping princess in penguin room.csv")
infl.id <- c(44, 106, 145)
DF.1 <- DF[-as.numeric(infl.id),]
life.1 <- DF.1[[3]]
gdp.1 <- DF.1[[4]]; sani.1 <- DF.1[[5]]; pre.1 <- DF.1[[6]]; pri.1 <- DF.1[[7]]
sec.1 <- DF.1[[8]]; ter.1 <- DF.1[[9]]; smo.1 <- DF.1[[11]]; ob.1 <- DF.1[[12]]
al.1 <- DF.1[[13]]; co2.1 <- DF.1[[14]]; hiv.1 <- DF.1[[15]]
n.1 <- nrow(DF.1); p <- ncol(DF.1) - 4
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
log.gdp <- log(gdp.1, 10); log.co2 <- log(co2.1, 2); log.hiv <- log(hiv.1, 2)
reg.log <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
obg.log <- summary(reg.log)
cp.X <- as.data.frame(cbind(gdp = gdp.1, sani = sani.1, pre = pre.1, pri = pri.1,
ter = ter.1, smo = smo.1, ob = ob.1, hiv = hiv.1))
reg.1
reg.cp <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+ter.1+smo.1+ob.1+hiv.1)
anova(reg.cp, reg.1)
cp.logX <- as.data.frame(cbind(log.gdp = log.gdp, sani = sani.1, pre = pre.1, pri = pri.1,
ter = ter.1, smo = smo.1, log.co2 = log.co2, log.hiv = log.hiv))
reg.cplog <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+ter.1+smo.1+log.co2+log.hiv)
anova(reg.cplog, reg.0)
anova(reg.cplog, reg.log)
list.obj <- list()
for (j in c(1:8)){
obj <- lm(life.1 ~ cp.X[,j])
list.obj[j] <- obj
}
par(mfrow = c(3, 3))
for (j in c(1:8)){
plot(cp.X[,j], life.1, color=c("white","gray"), xlab=colnames(cp.X)[j], main=paste("x", j))
abline(lm(life.1~cp.X[,j]), col="red")
}
par(mfrow = c(4, 2))
for (j in c(1:8)){
plot(cp.X[,j], life.1, color=c("white","gray"), xlab=colnames(cp.X)[j], main=paste("x", j))
abline(lm(life.1~cp.X[,j]), col="red")
}
par(mfrow = c(2, 4))
for (j in c(1:8)){
plot(cp.X[,j], life.1, color=c("white","gray"), xlab=colnames(cp.X)[j], main=paste("x", j))
abline(lm(life.1~cp.X[,j]), col="red")
}
list.objlog <- list()
for (j in c(1:8)){
objlog <- lm(life.1 ~ cp.logX[,j])
list.objlog[j] <- objlog
}
par(mfrow = c(2, 4))
for (j in c(1:8)){
plot(cp.logX[,j], life.1, color=c("white","gray"), xlab=colnames(cp.logX)[j], main=paste("x", j))
abline(lm(life.1~cp.logX[,j]), col="red")
}
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
DF <- read.csv("Sleeping princess in penguin room.csv")
infl.id <- c(44, 106, 145)
DF.1 <- DF[-as.numeric(infl.id),]
life.1 <- DF.1[[3]]
gdp.1 <- DF.1[[4]]; sani.1 <- DF.1[[5]]; pre.1 <- DF.1[[6]]; pri.1 <- DF.1[[7]]
sec.1 <- DF.1[[8]]; ter.1 <- DF.1[[9]]; smo.1 <- DF.1[[11]]; ob.1 <- DF.1[[12]]
al.1 <- DF.1[[13]]; co2.1 <- DF.1[[14]]; hiv.1 <- DF.1[[15]]
rm(list=ls())
DF <- read.csv("Sleeping princess in penguin room.csv")
infl.id <- c(44, 106, 145)
DF.1 <- DF[-as.numeric(infl.id),]
life.1 <- DF.1[[3]]
gdp.1 <- DF.1[[4]]; sani.1 <- DF.1[[5]]; pre.1 <- DF.1[[6]]; pri.1 <- DF.1[[7]]
sec.1 <- DF.1[[8]]; ter.1 <- DF.1[[9]]; smo.1 <- DF.1[[11]]; ob.1 <- DF.1[[12]]
al.1 <- DF.1[[13]]; co2.1 <- DF.1[[14]]; hiv.1 <- DF.1[[15]]
n.1 <- nrow(DF.1); p <- ncol(DF.1) - 4
library(corrplot); library(DAAG)
reg.r <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+ter.1+smo.1+ob.1+hiv.1)
DF.r <- as.data.frame(cbind(life = life.1, gdp = gdp.1, sani = sani.1, pre = pre.1,
pri = pri.1, ter = ter.1, smo = smo.1, ob = ob.1, hiv = hiv.1))
plot(DF.r)
plot(DF.r[,-1])
cor1.matrix <- matrix(0,8,8)
colnames(cor1.matrix) <- rownames(cor1.matrix) <- colnames(DF.r)[-1]
for(i in 1:8){
for(j in 1:8){
a <- cor(DF.r[,i+1], DF.r[,j+1])
cor1.matrix[i,j] <- a
}
}
round(cor1.matrix, 4)
vif(reg.r)
log.gdp <- log(gdp.1, 10); log.co2 <- log(co2.1, 2); log.hiv <- log(hiv.1, 2)
reg.logr <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+ter.1+smo.1+log.co2+log.hiv)
DF.logr<- as.data.frame(cbind(life = life.1, log.gdp = log.gdp, sani = sani.1, pre = pre.1,
pri = pri.1, ter = ter.1, smo = smo.1, log.co2 = log.co2, log.hiv = log.hiv))
plot(DF.logr)
plot(DF.logr[,-1])
round(cor1.matrix, 4)
vif(reg.r)
log.gdp <- log(gdp.1, 10); log.co2 <- log(co2.1, 2); log.hiv <- log(hiv.1, 2)
reg.logr <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+ter.1+smo.1+log.co2+log.hiv)
plot(DF.logr[,-1])
DF.logr<- as.data.frame(cbind(life = life.1, log.gdp = log.gdp, sani = sani.1, pre = pre.1,
pri = pri.1, ter = ter.1, smo = smo.1, log.co2 = log.co2, log.hiv = log.hiv))
corrplot(DF.r, method="number")
cor.matrix <- matrix(0,8,8)
corrplot(DF.r, method="number")
cor.matrix <- matrix(0,8,8)
colnames(cor.matrix) <- rownames(cor.matrix) <- colnames(DF.logr)[-1]
cor(sani.1, log.co2)
for(i in 1:8){
for(j in 1:8){
a <- cor(DF.logr[,i+1], DF.logr[,j+1])
cor.matrix[i,j] <- a
}
}
round(cor.matrix, 4)
vif(reg.logr)  ##10 or 4를 넘으면 공선성 있다고 생각한다.
vif(reg.logr)
anova(reg.r, reg.logr)
AIC(reg.r, reg.logr)
BIC(reg.r, reg.logr)
