setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
DF <- read.csv("Sleeping princess in penguin room.csv")
life <- DF[[3]]
gdp <- DF[[4]]; sani <- DF[[5]]; pre <- DF[[6]]; pri <- DF[[7]]
sec <- DF[[8]]; ter <- DF[[9]]; smo <- DF[[11]]; ob <- DF[[12]]
al <- DF[[13]]; co2 <- DF[[14]]; hiv <- DF[[15]]
n <- nrow(DF); p <- ncol(DF) - 4
reg <- lm(life~gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv)
par(mfrow = c(1,2))
plot(reg$residuals, type = "n", main = "residual plot", ylab = "residuals"); abline(h=0, lty="dotted")
text(reg$residuals, names(reg$residuals), cex = 0.7)
plot(reg$fitted.values, reg$residuals, type = "n", main = "residual plot", xlab = "y.hat", ylab = "residuals")
abline(h = 0, lty = "dotted")
library(lmtest)
dwtest(life ~ gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv) # H0이 독립.
anova.reg <- anova(reg); anova.reg
r <- reg$residuals
DF$Country.Name[which(reg$fitted.values >= 75)]
text(reg$fitted.values, reg$residuals, names(reg$fitted.values), cex = 0.7)
t <- r * sqrt(abs(temp)) * sign(temp)
t.r <- rstudent(reg)
plot(t)
abline(h = c(qt(1-alpha/2, n - p - 2), -qt(1-alpha/2, n - p - 2)), col = 2)
t.r <- rstudent(reg)
out.id <- which(abs(t.r) > qt(1-alpha/2, n - p - 2)); out.id
alpha <- 0.05
t.r <- rstudent(reg)
out.id <- which(abs(t.r) > qt(1-alpha/2, n - p - 2)); out.id
y.hat <- reg$fitted.values
par(mfrow=c(1,1))
plot(t.r, type = "n", xlab = "index", ylab = "studentized residual", main="studentized residual")
text(t.r, cex = 0.7)
text(out.id, t.r[out.id], out.id, col=2, cex = 0.7)
abline(h = 0, col = 2, lty = 2)
points(out.id, t.r[out.id], col = 4, cex = 3)
lm(life~smo)
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
DF <- read.csv("Sleeping princess in penguin room.csv")
life <- DF[[3]]
gdp <- DF[[4]]; sani <- DF[[5]]; pre <- DF[[6]]; pri <- DF[[7]]
sec <- DF[[8]]; ter <- DF[[9]]; smo <- DF[[11]]; ob <- DF[[12]]
al <- DF[[13]]; co2 <- DF[[14]]; hiv <- DF[[15]]
n <- nrow(DF); p <- ncol(DF) - 4
reg <- lm(life~gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv)
infl.id <- c(44, 106, 145)
DF.1 <- DF[-as.numeric(infl.id),]
life.1 <- DF.1[[3]]
gdp.1 <- DF.1[[4]]; sani.1 <- DF.1[[5]]; pre.1 <- DF.1[[6]]; pri.1 <- DF.1[[7]]
sec.1 <- DF.1[[8]]; ter.1 <- DF.1[[9]]; smo.1 <- DF.1[[11]]; ob.1 <- DF.1[[12]]
n.1 <- nrow(DF.1); p <- ncol(DF.1) - 4
al.1 <- DF.1[[13]]; co2.1 <- DF.1[[14]]; hiv.1 <- DF.1[[15]]
reg.f <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
log.gdp <- log(gdp.1, 10); log.co2 <- log(co2.1, 2); log.hiv <- log(hiv.1, 2)
reg.log <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
obg.log <- summary(reg.log)
round(obg.log$coefficients, 4)
obj <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
all((summary(obj)$coefficients)[-1,4] <= 0.15)
which.max((summary(obj)$coefficients)[-1,4])
obj <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+hiv.1)
all((summary(obj)$coefficients)[-1,4] <= 0.15)
which.max((summary(obj)$coefficients)[-1,4])
obj <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+hiv.1)
all((summary(obj)$coefficients)[-1,4] <= 0.15)
which.max((summary(obj)$coefficients)[-1,4])
obj <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+ter.1+smo.1+ob.1+hiv.1)
all((summary(obj)$coefficients)[-1,4] <= 0.15)
obj <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
all((summary(obj)$coefficients)[-1,4] <= 0.15)
which.max((summary(obj)$coefficients)[-1,4])
obj <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
which.max((summary(obj)$coefficients)[-1,4])
all((summary(obj)$coefficients)[-1,4] <= 0.15)
all((summary(obj)$coefficients)[-1,4] <= 0.15)
obj <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+ter.1+smo.1+al.1+log.co2+log.hiv)
which.max((summary(obj)$coefficients)[-1,4])
obj <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+ter.1+smo.1+log.co2+log.hiv)
all((summary(obj)$coefficients)[-1,4] <= 0.15)
library(leaps)
best.obj <- regsubsets(life.1 ~ ., DF.1[,-c(1, 2, 3, 10)])
obj <- summary(best.obj)
obj$rsq
obj$which
which.max(obj$adjr2)
which.min(obj$cp)
which.min(obj$bic)
bic.1 <- lm(life.1~gdp.1+sani.1+pre.1+hiv.1)
summary(bic.1)
df2 <- as.data.frame(cbind(log.gdp, sani.1, pre.1, pri.1, sec.1, ter.1, smo.1, ob.1, al.1 ,log.co2 ,log.hiv))
best.obj <- regsubsets(life.1 ~ ., df2)
obj <- summary(best.obj)
obj$which
obj$rsq
which.max(obj$adjr2)
which.min(obj$cp)
which.min(obj$bic)
bic.log <- lm(life.1~log.gdp+sani.1+pre.1+log.hiv)
summary(bic.log)
setwd("c:/Users/정은/Desktop/new_bigdata_set/Final Total Data")
DF <- read.csv("Sleeping princess in penguin room.csv")
life <- DF[[3]]
gdp <- DF[[4]]; sani <- DF[[5]]; pre <- DF[[6]]; pri <- DF[[7]]
sec <- DF[[8]]; ter <- DF[[9]]; smo <- DF[[11]]; ob <- DF[[12]]
al <- DF[[13]]; co2 <- DF[[14]]; hiv <- DF[[15]]
n <- nrow(DF); p <- ncol(DF) - 4
reg.full <- lm(life~gdp+sani+pre+pri+sec+ter+smo+ob+al+co2+hiv)
infl.id <- c(44, 106, 145)
DF.1 <- DF[-as.numeric(infl.id),]
life.1 <- DF.1[[3]]
gdp.1 <- DF.1[[4]]; sani.1 <- DF.1[[5]]; pre.1 <- DF.1[[6]]; pri.1 <- DF.1[[7]]
sec.1 <- DF.1[[8]]; ter.1 <- DF.1[[9]]; smo.1 <- DF.1[[11]]; ob.1 <- DF.1[[12]]
n.1 <- nrow(DF.1); p <- ncol(DF.1) - 4
log.gdp <- log(gdp.1, 10); log.co2 <- log(co2.1, 2); log.hiv <- log(hiv.1, 2)
reg.log <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
bic.1 <- lm(life.1~gdp.1+sani.1+pre.1+hiv.1)
anova(reg.1); anova(bic.1)
anova(bic.1, reg.1) #H0 : reduced / 기각이 되어서 reduced one을 쓸수가 없다.
anova(bic.log, reg.log)
F.stat <- ((SSE.r-SSE.f)/(DF.Er - DF.Ef))/(SSE.f/DF.Ef)  ##p.value (0.003)
SSE.r <- anova(bic.log)[5,2]; DF.Er <- 139
obg.log <- summary(reg.log)
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
round(obg.log$coefficients, 4)
SSE.r <- anova(bic.1)[5,2]; DF.Er <- 139
al.1 <- DF.1[[13]]; co2.1 <- DF.1[[14]]; hiv.1 <- DF.1[[15]]
SSE.f <- anova(reg.log)[12,2]; DF.Ef <- 135
obg.reg <- summary(reg.1)
bic.log <- lm(life.1~log.gdp+sani.1+pre.1+log.hiv)
F.stat <- ((SSE.r-SSE.f)/(DF.Er - DF.Ef))/(SSE.f/DF.Ef)  ##p.value (0.002)
reg.1 <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+co2.1+hiv.1)
reg.log <- lm(life.1~log.gdp+sani.1+pre.1+pri.1+sec.1+ter.1+smo.1+ob.1+al.1+log.co2+log.hiv)
SSE.f <- anova(reg.1)[12,2]; DF.Ef <- 135
obg.reg
reg.1
reg.cp <- lm(life.1~gdp.1+sani.1+pre.1+pri.1+ter.1+smo.1+ob.1+hiv.1)
anova(reg.cp, reg.1)
anova(reg.1, reg.cp)
summary(reg.cp)
reg.log
reg.logcp<- lm(life.1~log.gdp+sani.1+pre.1+pri.1+ter.1+smo.1+log.co2+log.hiv)
anova(reg.logcp, reg.log)
summary(reg.logcp)
summary(reg.logcp)
