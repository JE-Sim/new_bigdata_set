setwd("C:/Users/정은/Desktop/new_bigdata_set/new data revised")
setwd("c:/Users/정은/Desktop/new_bigdata_set/above 2000")
KNN <- function(data, year){
if(length(which(is.na(data[,year]))) == 0) return(data[,c(1,2, year)])
na.row <- which(is.na(data[, year])) #기준 년도에서 NA인 row추출
for(i in 1:length(na.row)){
col <- !is.na(data[na.row[i],]) #key observation에서 NA가 아닌 col 추출
collected.col <- data[, col] #data에서 col column들을 추출
key <- collected.col[na.row[i],] #key observation의 row 추출
index <- complete.cases(collected.col)
non.na <- collected.col[index,]
a <- apply(as.data.frame(non.na[,-c(1,2)]), 1, "-", key[,-c(1,2)]) #두 값의 차
b <- unlist(a) ^ 2 #차의 제곱
c <- as.data.frame(matrix(b, length(b)/(length(collected.col)-2),
length(collected.col)-2, byrow = T)) #vector b를 data.frame으로 형변환
colnames(c) <- colnames(non.na)[-c(1, 2)]
p.length <- apply(c, 1, sum) #각 년도별로 구해진 길이들의 평균.
n.point <- order(p.length)[2:6] #첫번째 요소는 자기 자신이라서 제외해줬다. key와 가장 가까운 5개의 point 추출
d <- data[n.point, year] #key와 가까운 5개의 point의 점수 추출
data[na.row[i], year] <- mean(d, na.rm = T) # 추출된 근처 값들의 평균을 넣어줌.
}
return(answer <- data[,c(1, 2, year)])
}
life <- read.csv("life.rm.csv")
life.0 <- KNN(life, 18)
gdp <- read.csv("gdp.rm.csv")
gdp.0 <- KNN(gdp, 19)
co2 <- read.csv("co2.rm.csv")
co2.0 <- KNN(co2, 17)
ter <- read.csv("ter.rm.csv")
ter.0 <- KNN(ter, 18)
smo <- read.csv("smo.rm.2.CSV")
which(is.na(smo[,3]))
which(is.na(smo[,4]))
avg <- apply(smo[,c(3,4)], 2, mean, na.rm = T)
smo[which(is.na(smo[,3])),3] <- avg[1]
smo[which(is.na(smo[,4])),4] <- avg[2]
sec <- read.csv("sec.rm.csv")
sec.0 <- KNN(sec, 18)
obesity <- read.csv("Obesity.rm.csv", header=T)
KNN(obesity, 19)
obs.0 <- obesity[,c(1, 2, 19)]
hiv <- read.csv("hiv.rm.csv")
hiv.0 <- KNN(hiv, 19)
pre <- read.csv("pre.rm.csv")
pre.0 <- KNN(pre, 18)
pri <- read.csv("pri.rm.csv")
pri.0 <- KNN(pri, 18)
sani <- read.csv("sani.rm.csv")
sani.0 <- KNN(sani, 18)
setwd("C:/Users/정은/Desktop/new_bigdata_set/new data revised")
write.csv(co2.0, "co2.rv.csv", row.names = F)
write.csv(gdp.0, "gdp.rv.csv", row.names = F)
write.csv(hiv.0, "hiv.rv.csv", row.names = F)
write.csv(life.0, "life.rv.csv", row.names = F)
write.csv(obs.0, "ob.rv.csv", row.names = F)
write.csv(pre.0, "pre.rv.csv", row.names = F)
write.csv(pri.0, "pri.rv.csv", row.names = F)
write.csv(sani.0, "sani.rv.csv", row.names = F)
write.csv(smo, "smo.rv.csv", row.names = F)
write.csv(sec.0, "sec.rv.csv", row.names = F)
write.csv(ter.0, "ter.rv.csv", row.names = F)
setwd("C:/Users/정은/Desktop/new_bigdata_set/new data revised")
co2 <- read.csv("co2.rv.csv")
rm(list=ls())
co2 <- read.csv("co2.rv.csv")
gdp <- read.csv("gdp.rv.csv")
hiv <- read.csv("hiv.rv.csv")
life <- read.csv("life.rv.csv")
ob <- read.csv("ob.rv.csv")
pre <- read.csv("pre.rv.csv")
pri <- read.csv("pri.rv.csv")
sani <- read.csv("sani.rv.csv")
sec <- read.csv("sec.rv.csv")
smo <- read.csv("smo.rv.csv")
ter <- read.csv("ter.rv.csv")
al <- read.csv("al.rv.csv")
al <- read.csv("al.rv.csv")
co2 <- co2[order(co2$Country.Code),]
setwd("c:/Users/정은/Desktop/new_bigdata_set/above 2000")
al <- read.csv("al.rv.csv")
setwd("C:/Users/정은/Desktop/new_bigdata_set/new data revised")
al <- read.csv("al.rv.csv")
co2 <- co2[order(co2$Country.Code),]
gdp <- gdp[order(gdp$Country.Code),]
hiv <- hiv[order(hiv$Country.Code),]
life <- life[order(life$Country.Code),]
ob <- ob[order(ob$Country.Code),]
pre <- pre[order(pre$Country.Code),]
pri <- pri[order(pri$Country.Code),]
sani <- sani[order(sani$Country.Code),]
sec <- sec[order(sec$Country.Code),]
smo <- smo[order(smo$Country.Code),]
ter <- ter[order(ter$Country.Code),]
al <- al[order(al$Country.Code),]
p.name <- as.character(pri$Country.Code)
s.name <- as.character(sec$Country.Code)
common <- intersect(p.name, s.name)
pri.0 <- pri[pri$Country.Code %in% common,]
sec.0 <- sec[sec$Country.Code %in% common,]
merge(pri.0, sec.0)
row.names(pri.0)
c <- cbind(pri.0, sec.0$X2014)
c <- cbind(pri.0, sec.0$X2014)
a <- merge(life, gdp, key = Country.Code)
b <- merge(sani, pre, key = Country.Code)
d <- merge(ter, smo, key = Country.Code)
e <- merge(ob, al, key = Country.Code)
f <- merge(co2, hiv, key = Country.Code)
common1 <- intersect(as.character(a$Country.Code), as.character(b$Country.Code))
common1 <- intersect(common1, as.character(c$Country.Code))
common1 <- intersect(common1, as.character(d$Country.Code))
merge(pri.0, sec.0)
p.name <- as.character(pri$Country.Code)
s.name <- as.character(sec$Country.Code)
common <- intersect(p.name, s.name)
pri.0 <- pri[pri$Country.Code %in% common,]
sec.0 <- sec[sec$Country.Code %in% common,]
merge(pri.0, sec.0)
row.names(pri.0)
c <- cbind(pri.0, sec.0$X2014)
common <- intersect(p.name, s.name)
pri.0 <- pri[pri$Country.Code %in% common,]
sec.0 <- sec[sec$Country.Code %in% common,]
c <- cbind(pri.0, sec.0$X2014)
View(pri.0)
View(sec.0)
View(sec.0)
pri.0
sec.0$X2014
View(sec.0)
c <- cbind(pri.0, sec.0[,3])
a <- merge(life, gdp, key = Country.Code)
b <- merge(sani, pre, key = Country.Code)
d <- merge(ter, smo, key = Country.Code)
e <- merge(ob, al, key = Country.Code)
f <- merge(co2, hiv, key = Country.Code)
common1 <- intersect(as.character(a$Country.Code), as.character(b$Country.Code))
common1 <- intersect(common1, as.character(c$Country.Code))
common1 <- intersect(common1, as.character(d$Country.Code))
common1 <- intersect(common1, as.character(e$Country.Code))
a.0 <- a[a$Country.Code %in% common1,]
b.0 <- b[b$Country.Code %in% common1,]
c.0 <- c[c$Country.Code %in% common1,]
d.0 <- d[d$Country.Code %in% common1,]
e.0 <- e[e$Country.Code %in% common1,]
df <- cbind(a.0, b.0[,3:4], c.0[,3:4], d.0[,3:5], e.0[,3:4])
View(b.0)
a <- merge(life, gdp, key = Country.Code)
b <- merge(sani, pre, key = Country.Code)
d <- merge(ter, smo, key = Country.Code)
b <- merge(sani, pre, key = Country.Code)
d <- merge(ter, smo, key = Country.Code)
e <- merge(ob, al, key = Country.Code)
f <- merge(co2, hiv, key = Country.Code)
a <- merge(life, gdp, key = Country.Code)
b <- merge(sani, pre, key = Country.Code)
d <- merge(ter, smo, key = Country.Code)
e <- merge(ob, al, key = Country.Code)
rm(list=ls())
setwd("C:/Users/정은/Desktop/new_bigdata_set/new data revised")
co2 <- read.csv("co2.rv.csv")
gdp <- read.csv("gdp.rv.csv")
hiv <- read.csv("hiv.rv.csv")
life <- read.csv("life.rv.csv")
ob <- read.csv("ob.rv.csv")
pre <- read.csv("pre.rv.csv")
pri <- read.csv("pri.rv.csv")
sani <- read.csv("sani.rv.csv")
sec <- read.csv("sec.rv.csv")
smo <- read.csv("smo.rv.csv")
ter <- read.csv("ter.rv.csv")
al <- read.csv("al.rv.csv")
co2 <- co2[order(co2$Country.Code),]
gdp <- gdp[order(gdp$Country.Code),]
hiv <- hiv[order(hiv$Country.Code),]
life <- life[order(life$Country.Code),]
ob <- ob[order(ob$Country.Code),]
pre <- pre[order(pre$Country.Code),]
pri <- pri[order(pri$Country.Code),]
sani <- sani[order(sani$Country.Code),]
sec <- sec[order(sec$Country.Code),]
smo <- smo[order(smo$Country.Code),]
ter <- ter[order(ter$Country.Code),]
al <- al[order(al$Country.Code),]
common <- intersect(as.character(gdp$Country.Code), as.character(sani$Country.Code))
name <- as.character(c(gdp[,2], sani[,2], pre[,2], pri[,2], sec[,2], ter[,2],
smo[,2], ob[,2], al[,2], co2[,2], hiv[,2]))
name <-c(gdp[,2], sani[,2], pre[,2], pri[,2], sec[,2], ter[,2],
smo[,2], ob[,2], al[,2], co2[,2], hiv[,2])
View(gdp)
gdp[,2]
name <-c(as.character(gdp[,2]), as.character(sani[,2]), as.character(pre[,2]), as.character(pri[,2]),
as.character(sec[,2]), as.character(ter[,2]), as.character(smo[,2]), as.character(ob[,2]),
as.character(al[,2]), as.character(co2[,2]), as.character(hiv[,2]))
name <-as.data.frame(as.character(gdp[,2]), as.character(sani[,2]), as.character(pre[,2]), as.character(pri[,2]),
as.character(sec[,2]), as.character(ter[,2]), as.character(smo[,2]), as.character(ob[,2]),
as.character(al[,2]), as.character(co2[,2]), as.character(hiv[,2]))
name <-as.list(as.character(gdp[,2]), as.character(sani[,2]), as.character(pre[,2]), as.character(pri[,2]),
as.character(sec[,2]), as.character(ter[,2]), as.character(smo[,2]), as.character(ob[,2]),
as.character(al[,2]), as.character(co2[,2]), as.character(hiv[,2]))
name <-as.list(gdp = as.character(gdp[,2]), sani = as.character(sani[,2]), pre = as.character(pre[,2]),
pri = as.character(pri[,2]), sec = as.character(sec[,2]), ter = as.character(ter[,2]),
smo = as.character(smo[,2]), ob = as.character(ob[,2]), al = as.character(al[,2]),
co2 = as.character(co2[,2]), hiv = as.character(hiv[,2]))
